<div class="page">
  <header class="header">
    <div class="brand">
      <img src="assets/logo.webp" class="logo" alt="Logo tr∆∞·ªùng" />
      <div class="brand-text">
        <div class="brand-name">ƒê·∫†I H·ªåC X√ÇY D·ª∞NG</div>
        <div class="brand-sub">Dashboard</div>
      </div>
    </div>
    <div class="header-right">
      <button class="bell" aria-label="Th√¥ng b√°o">üîî</button>
      <div class="user">
        <div class="user-name">{{ principal.name }}</div>
        <div class="avatar"></div>
      </div>
    </div>
  </header>


  <app-sidebar [sidebarOpen]="sidebarOpen" (toggleSidebarEvent)="toggleSidebar()"></app-sidebar>

  <!-- Test -->
  <!-- <div class="menu-toggle-wrapper" [class.shift-right]="sidebarOpen">
    <button class="menu-toggle" (click)="toggleSidebar()">‚ò∞</button>
  </div>

  <aside class="sidebar" [class.open]="sidebarOpen">
    <div class="sidebar-header">
      <img src="assets/logo.webp" class="sidebar-logo" alt="Logo" />
      <button class="close-sidebar" (click)="toggleSidebar()">‚úñ</button>
    </div>
    <nav class="sidebar-nav">
      <button class="nav-item active">üè† Trang ch·ªß</button>

      <div class="dropdown">
        <button class="nav-item dropdown-toggle" (click)="toggleDropdown()">
          <span class="icon">üìà</span>
          Qu·∫£n l√Ω KPI
          <span class="arrow" [class.open]="dropdownOpen">‚ñº</span>
        </button>
        <div class="dropdown-menu" *ngIf="dropdownOpen">
          <button class="nav-item sub-item" (click)="goAssign()">
            ‚ûï Giao KPI
          </button>
          <button class="nav-item sub-item">‚úÖ Ph√™ duy·ªát KPI</button>
          <button class="nav-item sub-item">üìä Xem b√°o c√°o</button>
          <button class="nav-item sub-item">‚¨áÔ∏è Xu·∫•t Excel/PDF</button>
        </div>
      </div>
    </nav>
  </aside> -->

  <!-- EndTesst -->




  <main class="grid">
    <section class="card profile">
      <div class="avatar lg"></div>
      <div class="info">
        <div class="name">{{ principal.name }}</div>
        <div class="row">
          <span class="label">Ch·ª©c v·ª•:</span> {{ principal.role }}
        </div>
        <div class="row">
          <span class="label">M√£ CB:</span> {{ principal.code }}
        </div>
        <div class="row">
          <span class="label">Nhi·ªám k·ª≥:</span> {{ principal.term }}
        </div>
        <div class="row">
          <span class="label">Email:</span> {{ principal.email }}
        </div>
        <div class="row">
          <span class="label">ƒêi·ªán tho·∫°i:</span> {{ principal.phone }}
        </div>
      </div>
    </section>

    <section class="card overview">
      <div class="card-title">KPI t·ªïng quan to√†n tr∆∞·ªùng</div>
      <div class="overview-wrap">
        <div class="gauge" [style.--val]="overview.percent">
          <div class="gauge-hole">
            <div class="gauge-value">{{ overview.percent }}%</div>
            <div class="muted">Ho√†n th√†nh</div>
          </div>
        </div>
        <div class="stats">
          <div class="stat">
            <div class="num">{{ overview.total }}</div>
            <div class="lbl">KPI ƒë√£ giao</div>
          </div>
          <div class="stat">
            <div class="num">{{ overview.done }}</div>
            <div class="lbl">KPI ho√†n th√†nh</div>
          </div>
          <div class="stat">
            <div class="num">{{ overview.inProgress }}</div>
            <div class="lbl">ƒêang th·ª±c hi·ªán</div>
          </div>
          <div class="stat">
            <div class="num">{{ overview.ontime }}</div>
            <div class="lbl">ƒê√∫ng h·∫°n</div>
          </div>
          <div class="stat">
            <div class="num warn">{{ overview.late }}</div>
            <div class="lbl">Tr·ªÖ h·∫°n</div>
          </div>
        </div>
      </div>
    </section>

    <section class="card deputies">
      <div class="card-title">Ti·∫øn ƒë·ªô theo nh√≥m Ph√≥ Hi·ªáu tr∆∞·ªüng</div>
      <div class="rows">
        <div class="row" *ngFor="let d of deputies">
          <div class="cell name">{{ d.name }}</div>
          <div class="cell grow">
            <div class="progress">
              <div class="bar" [style.width]="widthPct(d.progress)"></div>
            </div>
            <div class="small muted">{{ d.progress }}%</div>
          </div>
          <div class="cell small">ƒê√∫ng h·∫°n: {{ d.ontime }}</div>
          <div class="cell small warn">Tr·ªÖ: {{ d.late }}</div>
          <button class="btn ghost">Chi ti·∫øt</button>
        </div>
      </div>
    </section>

    <section class="card units">
      <div class="card-title">Top ƒë∆°n v·ªã</div>
      <div class="table">
        <div class="thead">
          <div>ƒê∆°n v·ªã</div>
          <div>% ho√†n th√†nh</div>
          <div>ƒê√∫ng h·∫°n</div>
          <div>Tr·ªÖ</div>
        </div>
        <div class="row" *ngFor="let u of topUnits">
          <div class="cell name">{{ u.unit }}</div>
          <div class="cell">
            <div class="progress">
              <div class="bar ok" [style.width]="widthPct(u.progress)"></div>
            </div>
            <div class="small muted">{{ u.progress }}%</div>
          </div>
          <div class="cell small">{{ u.ontime }}</div>
          <div class="cell small warn">{{ u.late }}</div>
        </div>
      </div>
    </section>

    <section class="card units">
      <div class="card-title">ƒê∆°n v·ªã c·∫ßn ch√∫ √Ω</div>
      <div class="table">
        <div class="thead">
          <div>ƒê∆°n v·ªã</div>
          <div>% ho√†n th√†nh</div>
          <div>ƒê√∫ng h·∫°n</div>
          <div>Tr·ªÖ</div>
        </div>
        <div class="row" *ngFor="let u of weakUnits">
          <div class="cell name">{{ u.unit }}</div>
          <div class="cell">
            <div class="progress">
              <div
                class="bar danger"
                [style.width]="widthPct(u.progress)"
              ></div>
            </div>
            <div class="small muted">{{ u.progress }}%</div>
          </div>
          <div class="cell small">{{ u.ontime }}</div>
          <div class="cell small warn">{{ u.late }}</div>
        </div>
      </div>
    </section>

    <section class="card alerts">
      <div class="card-title">C·∫£nh b√°o KPI</div>
      <div class="table">
        <div class="thead">
          <div>KPI</div>
          <div>ƒê∆°n v·ªã</div>
          <div>Tr·∫°ng th√°i</div>
          <div>H·∫°n</div>
        </div>
        <div class="row" *ngFor="let a of alerts">
          <div class="cell name">{{ a.kpi }}</div>
          <div class="cell small">{{ a.unit }}</div>
          <div class="cell small" [class.warn]="a.status === 'Tr·ªÖ h·∫°n'">
            {{ a.status }}
          </div>
          <div class="cell small">{{ a.due }}</div>
        </div>
      </div>
    </section>

    <section class="card trend">
      <div class="card-title">Xu h∆∞·ªõng ho√†n th√†nh theo th√°ng</div>
      <div class="spark">
        <svg viewBox="0 0 600 180" role="img" aria-label="Xu h∆∞·ªõng KPI">
          <line x1="10" y1="150" x2="590" y2="150" class="axis" />
          <line x1="10" y1="30" x2="10" y2="150" class="axis" />
          <polyline
            class="line"
            [attr.points]="
              '10,' +
              (150 - (monthly[0] / 100) * 120) +
              ' ' +
              '90,' +
              (150 - (monthly[1] / 100) * 120) +
              ' ' +
              '170,' +
              (150 - (monthly[2] / 100) * 120) +
              ' ' +
              '250,' +
              (150 - (monthly[3] / 100) * 120) +
              ' ' +
              '330,' +
              (150 - (monthly[4] / 100) * 120) +
              ' ' +
              '410,' +
              (150 - (monthly[5] / 100) * 120) +
              ' ' +
              '490,' +
              (150 - (monthly[6] / 100) * 120) +
              ' ' +
              '570,' +
              (150 - (monthly[7] / 100) * 120)
            "
          ></polyline>
        </svg>
        <div class="hint muted">* M·ªëc: Jan ‚Üí Aug</div>
      </div>
    </section>
  </main>
</div>
